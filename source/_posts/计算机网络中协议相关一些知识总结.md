---
title: 计算机网络中协议相关一些知识总结
author: Darifo
Github: 'https://github.com/darifo'
Pages: 'https://darifo.github.io/'
date: 2020-04-04 11:59:53
categories:
- 计算机网络
tags:
- HTTP
- TCP/UDP/IP
- SSL/TLS
---


### OSI七层

自顶向下： 

- 应用层
- 表示层
- 会话层
- 传输层
- 网络层
- 数据链路层
- 物理层


### TCP/IP四层

- 应用层
- 运输层
- 网际层
- 网络接口层



### TCP三次握手四次挥手

#### 三次握手

1、客户端发送 **SYN** 到 服务端

2、服务端 返回 **SYN/ACK** 给 客户端

3、客户端 发送 **ACK** 给 服务端


#### 四次挥手

1、客户端 发送 **FIN** 到 服务端

2、服务端 响应 **ACK** 给 客户端

3、服务端 发送 **FIN** 到 客户端

4、客户端 发送 **ACK** 到 服务端



### TCP 和 UDP 比较

- TCP 面向连接 可靠 字节流 效率慢 资源消耗多 

- UDP 面向无连接 不可靠 数据报文段 效率快 资源消耗少


### TCP 如何保证数据传输可靠性


- 分割数据块
- 包编号，有序传输
- 校验和（差错控制）：端到端校验包的首部和数据是否变化
- 流量控制：利用滑动窗口协议控制
- 拥塞控制：网络拥堵，减少发送
- ARQ协议：发完一个分组停止等待，确认收到再继续发。分为 停止等待ARQ 和 连续ARQ
- 超时重传


### 浏览器中输入url后到页面显示发生什么


1、【DNS解析】浏览器 查找 域名 的 IP 地址 

- 本地系统 hosts
- 路由器缓存
- DNS 服务器缓存

2、【TCP连接 & 发起 HTTP 请求】浏览器 向 服务器 发送 HTTP 请求

建立TCP连接（三次握手）：

- 应用层 HTTP 协议 请求数据分组 封包 
- 传输层 TCP 协议
- 到 网络层 使用 OSPF（开放最短路径优先协议）路由器间寻址、IP 协议 发送数据 
- 数据链路层 ARP 协议 将 ip地址转换为MAC地址
- 物理层 服务器 网卡设备
- 反向解包操作...
  
3、【接收处理请求 & 响应 HTTP】服务器处理请求，并响应

- 应用层 HTTP 协议 处理数据并响应HTML
- 响应发送数据顺序同上...

4、【页面渲染】浏览器（客户端）接收响应，渲染页面

5、【TCP 结束】连接结束


### 状态码


- 1XX ：信息状态码 正在处理请求
- 2XX ：成功状态码 请求正常处理完成
- 3XX ：重定向状态码 
- 4XX ：客户端错误状态码 服务器无法处理请求
- 5XX ：服务器错误状态码 服务器处理请求出错 

HTTP/1.1 

409： 请求资源与当前资源状态发生冲突

410： 服务器上某个资源被永久删除



### Cookies 和 Session

- 两者都是用来跟踪浏览器用户身份的会话方式

- Cookie 一般保存用户信息，如登录信息，保持登录（下次访问自动登录，为了安全 ，一般使用加密token，每次登陆后刷新token）

- Session 通过服务端来记录用户状态

- Cookie 保存在客户端（浏览器），Session 保存在服务端

- Cookie 不要存敏感信息，一般加密，需要时去服务端解密

#### 无状态 HTTP协议 如何追踪服务端 Session

一般在客户端 Cookie 中加上一个 Session ID 实现 ，如果 客户端 Cookie 被禁用了，就通过重写 URL 把 Session ID 放在 URL 后面传到服务器
  

### HTTP 和 HTTPS


- 端口：HTTP 默认使用 80 端口；HTTPS 默认使用 443 端口。
- 安全性：HTTP 运行在 TCP 协议之上 ，所有传输内容为明文，无法验证双方身份；HTTPS 运行在 SSL/TLS 协议之上 的 HTTP 协议 ， SSL/TLS 运行在 TCP 之上，所有传输内容经过加密，加密本身使用对称加密，秘钥又使用服务器证书进行了非对称加密。
- 资源消耗：HTTPS 资源消耗高于 HTTP ， 因为要进行加解密，身份验证等



### 最后记住

- HTTP、HTTPS 是 应用层 协议
- TCP、UDP 是 传输层 协议
- IP、IPv6 是 网际层 协议
- SSL、TSL、RPC 是 会话层 协议
- PPTP、L2TP、ARP、RARP 是 数据链路层 协议
