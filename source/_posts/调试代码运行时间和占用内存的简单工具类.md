---
title: 调试代码运行时间和占用内存的简单工具类
author: Darifo
Github: 'https://github.com/darifo'
Pages: 'https://darifo.github.io/'
date: 2020-04-15 17:52:43
categories:
- 编程语言
tags:
- JAVA
---


功能简单，就是调试某一部分代码运行期间 占用内存 和 消耗时间 ，可以自行扩展或优化。。。

代码如下：

```java
package com.company.darifo.tools;

import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.util.Date;

/*
* 工具类 - 调试代码运行占用内存、消耗时间情况
* */
public class TimeMemUtil {
    static Runtime run;
    static double startMem, endMem;
    static DecimalFormat df = new DecimalFormat("#.######");
    static final double P = 1000.00d;
    static long startTime, endTime;
    static SimpleDateFormat simpleDateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");

    /*
    * 开始记录
    * */
    public static void start() {
        run = Runtime.getRuntime();
        startMem = ((run.totalMemory() - run.freeMemory()) / P / P);
        startTime = System.currentTimeMillis();
        System.out.println("【start】开始时间：" + simpleDateFormat.format(new Date(startTime)));
    }

    /*
    * 结束记录 并 输出从开始到结束的 内存、时间 使用情况
    * */
    public static void end() {
        endMem = ((run.totalMemory() - run.freeMemory()) / P / P);
        endTime = System.currentTimeMillis();
        System.out.println("【end】结束时间：" + simpleDateFormat.format(new Date(endTime)));
        System.out.println("[ start -> end ] 内存使用: " + df.format((endMem - startMem)) + " Mb");
        System.out.println("[ start -> end ] 耗时: " + (endTime - startTime) + " ms");
    }

    /*
    * 输出当前使用内存
    * */
    public static void dump() {
        double mem = ((run.totalMemory() - run.freeMemory()) / P / P);
        System.out.println("memory> used: " + df.format(mem) + " Mb");
    }

    /*
    * 释放内存 并输出 占用情况
    * */
    public static void gc() {
        run.gc();
        System.out.println("gc...");
        double total = run.totalMemory() / P / P;
        double free = run.freeMemory() / P / P;
        double mem = ((run.totalMemory() - run.freeMemory()) / P / P);
        System.out.println(
                "gc memory> 内存总量: " + df.format(total) + " Mb" +
                        " 空闲内存: " + df.format(free) + " Mb" +
                        " 已使用内存: " + df.format(mem) + " Mb"
        );
    }
}

```

使用：

```java
import com.company.darifo.tools.TimeMemUtil;

TimeMemUtil.start();
func(args);
TimeMemUtil.end();
```

运行时，会自动输出调用执行 函数 func 所需时间及占用内存。。